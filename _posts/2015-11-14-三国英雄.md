---
layout: post
title: 三国争霸，谁是英雄！
date: 2015-11-14
categories: blog
tags: [R,PCA]
description: 请叫我肖凯大神博客的搬运工
---

#The Hero of the Three Kingdoms 
##三国争霸，谁是英雄！

最近在看肖凯大神的Blog发现了一篇有趣的文章。用到的方法也比较简单，所以拿来自己也娱乐一下。

数据来源于肖凯大神提供。



```R
data<-read.csv("data_of_heros.csv")
```


```R
head(data)
```




<table>
<thead><tr><th></th><th scope=col>X</th><th scope=col>name</th><th scope=col>tongshuai</th><th scope=col>wuli</th><th scope=col>zhili</th><th scope=col>zhengzhi</th><th scope=col>meili</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>1</td><td>丁奉</td><td>68</td><td>80</td><td>64</td><td>72</td><td>71</td></tr>
	<tr><th scope=row>2</th><td>7</td><td>于禁</td><td>77</td><td>74</td><td>51</td><td>48</td><td>60</td></tr>
	<tr><th scope=row>3</th><td>8</td><td>于詮</td><td>60</td><td>56</td><td>44</td><td>52</td><td>61</td></tr>
	<tr><th scope=row>4</th><td>10</td><td>兀突骨</td><td>71</td><td>84</td><td>13</td><td>9</td><td>24</td></tr>
	<tr><th scope=row>5</th><td>12</td><td>土安</td><td>57</td><td>72</td><td>14</td><td>19</td><td>17</td></tr>
	<tr><th scope=row>6</th><td>21</td><td>尹大目</td><td>50</td><td>61</td><td>72</td><td>65</td><td>40</td></tr>
</tbody>
</table>




>数据描述


>整理之后只取了三国志四的部分，去除了分值为0的人物，整理后数据你可以从这里下载。整个数据有454名人物，包括了六个变量，分别为人物'名字'，'统率','武力','智力','政治','魅力'。我们可以使用plyr包中的arrange函数找到各指标分别对应的前十名。不出意外，武神关二爷获得统率第一，人中吕布获得武力第一，诸葛亮获得智力第一，张昭获得政治第一，而会哭的刘备获得魅力第一！


```R
library(plyr)
```


```R
arrange(data,desc(tongshuai))[1:10,]
```




<table>
<thead><tr><th></th><th scope=col>X</th><th scope=col>name</th><th scope=col>tongshuai</th><th scope=col>wuli</th><th scope=col>zhili</th><th scope=col>zhengzhi</th><th scope=col>meili</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>922</td><td>關羽</td><td>100</td><td>98</td><td>82</td><td>65</td><td>96</td></tr>
	<tr><th scope=row>2</th><td>551</td><td>曹操</td><td>99</td><td>88</td><td>92</td><td>97</td><td>98</td></tr>
	<tr><th scope=row>3</th><td>114</td><td>司馬懿</td><td>98</td><td>61</td><td>99</td><td>91</td><td>81</td></tr>
	<tr><th scope=row>4</th><td>272</td><td>周瑜</td><td>97</td><td>78</td><td>98</td><td>89</td><td>97</td></tr>
	<tr><th scope=row>5</th><td>828</td><td>諸葛亮</td><td>97</td><td>55</td><td>100</td><td>96</td><td>96</td></tr>
	<tr><th scope=row>6</th><td>614</td><td>陸遜</td><td>96</td><td>79</td><td>97</td><td>87</td><td>95</td></tr>
	<tr><th scope=row>7</th><td>741</td><td>趙雲</td><td>96</td><td>98</td><td>85</td><td>80</td><td>95</td></tr>
	<tr><th scope=row>8</th><td>364</td><td>孫堅</td><td>95</td><td>92</td><td>83</td><td>68</td><td>91</td></tr>
	<tr><th scope=row>9</th><td>371</td><td>孫策</td><td>95</td><td>93</td><td>85</td><td>69</td><td>92</td></tr>
	<tr><th scope=row>10</th><td>342</td><td>夏侯惇</td><td>94</td><td>96</td><td>62</td><td>56</td><td>78</td></tr>
</tbody>
</table>





```R
arrange(data,desc(wuli))[1:10,]
```




<table>
<thead><tr><th></th><th scope=col>X</th><th scope=col>name</th><th scope=col>tongshuai</th><th scope=col>wuli</th><th scope=col>zhili</th><th scope=col>zhengzhi</th><th scope=col>meili</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>188</td><td>呂布</td><td>78</td><td>100</td><td>30</td><td>13</td><td>40</td></tr>
	<tr><th scope=row>2</th><td>437</td><td>馬超</td><td>86</td><td>99</td><td>43</td><td>31</td><td>70</td></tr>
	<tr><th scope=row>3</th><td>488</td><td>張飛</td><td>79</td><td>99</td><td>39</td><td>22</td><td>39</td></tr>
	<tr><th scope=row>4</th><td>741</td><td>趙雲</td><td>96</td><td>98</td><td>85</td><td>80</td><td>95</td></tr>
	<tr><th scope=row>5</th><td>922</td><td>關羽</td><td>100</td><td>98</td><td>82</td><td>65</td><td>96</td></tr>
	<tr><th scope=row>6</th><td>258</td><td>典韋</td><td>74</td><td>97</td><td>33</td><td>20</td><td>56</td></tr>
	<tr><th scope=row>7</th><td>574</td><td>許褚</td><td>83</td><td>97</td><td>26</td><td>16</td><td>68</td></tr>
	<tr><th scope=row>8</th><td>658</td><td>黃忠</td><td>93</td><td>97</td><td>67</td><td>65</td><td>88</td></tr>
	<tr><th scope=row>9</th><td>48</td><td>文醜</td><td>85</td><td>96</td><td>20</td><td>12</td><td>57</td></tr>
	<tr><th scope=row>10</th><td>342</td><td>夏侯惇</td><td>94</td><td>96</td><td>62</td><td>56</td><td>78</td></tr>
</tbody>
</table>





```R
arrange(data,desc(zhili))[1:10,]
```




<table>
<thead><tr><th></th><th scope=col>X</th><th scope=col>name</th><th scope=col>tongshuai</th><th scope=col>wuli</th><th scope=col>zhili</th><th scope=col>zhengzhi</th><th scope=col>meili</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>828</td><td>諸葛亮</td><td>97</td><td>55</td><td>100</td><td>96</td><td>96</td></tr>
	<tr><th scope=row>2</th><td>114</td><td>司馬懿</td><td>98</td><td>61</td><td>99</td><td>91</td><td>81</td></tr>
	<tr><th scope=row>3</th><td>585</td><td>郭嘉</td><td>42</td><td>27</td><td>99</td><td>92</td><td>89</td></tr>
	<tr><th scope=row>4</th><td>272</td><td>周瑜</td><td>97</td><td>78</td><td>98</td><td>89</td><td>97</td></tr>
	<tr><th scope=row>5</th><td>913</td><td>龐統</td><td>90</td><td>60</td><td>98</td><td>86</td><td>83</td></tr>
	<tr><th scope=row>6</th><td>410</td><td>荀彧</td><td>64</td><td>35</td><td>97</td><td>90</td><td>84</td></tr>
	<tr><th scope=row>7</th><td>614</td><td>陸遜</td><td>96</td><td>79</td><td>97</td><td>87</td><td>95</td></tr>
	<tr><th scope=row>8</th><td>388</td><td>徐庶</td><td>87</td><td>67</td><td>96</td><td>88</td><td>84</td></tr>
	<tr><th scope=row>9</th><td>717</td><td>賈詡</td><td>75</td><td>30</td><td>96</td><td>93</td><td>67</td></tr>
	<tr><th scope=row>10</th><td>305</td><td>姜維</td><td>89</td><td>91</td><td>95</td><td>86</td><td>85</td></tr>
</tbody>
</table>





```R
arrange(data,desc(meili))[1:10,]
```




<table>
<thead><tr><th></th><th scope=col>X</th><th scope=col>name</th><th scope=col>tongshuai</th><th scope=col>wuli</th><th scope=col>zhili</th><th scope=col>zhengzhi</th><th scope=col>meili</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>769</td><td>劉備</td><td>60</td><td>72</td><td>76</td><td>85</td><td>99</td></tr>
	<tr><th scope=row>2</th><td>551</td><td>曹操</td><td>99</td><td>88</td><td>92</td><td>97</td><td>98</td></tr>
	<tr><th scope=row>3</th><td>272</td><td>周瑜</td><td>97</td><td>78</td><td>98</td><td>89</td><td>97</td></tr>
	<tr><th scope=row>4</th><td>382</td><td>孫權</td><td>89</td><td>82</td><td>87</td><td>73</td><td>97</td></tr>
	<tr><th scope=row>5</th><td>828</td><td>諸葛亮</td><td>97</td><td>55</td><td>100</td><td>96</td><td>96</td></tr>
	<tr><th scope=row>6</th><td>922</td><td>關羽</td><td>100</td><td>98</td><td>82</td><td>65</td><td>96</td></tr>
	<tr><th scope=row>7</th><td>614</td><td>陸遜</td><td>96</td><td>79</td><td>97</td><td>87</td><td>95</td></tr>
	<tr><th scope=row>8</th><td>741</td><td>趙雲</td><td>96</td><td>98</td><td>85</td><td>80</td><td>95</td></tr>
	<tr><th scope=row>9</th><td>832</td><td>諸葛瑾</td><td>56</td><td>47</td><td>89</td><td>90</td><td>94</td></tr>
	<tr><th scope=row>10</th><td>842</td><td>鄧芝</td><td>69</td><td>51</td><td>84</td><td>78</td><td>93</td></tr>
</tbody>
</table>




**由于每个人物对应多个指标，我们需要一个综合指标来比较，最简单的，上PCA。**


```R
prinModel<-prcomp(x=data[,3:7],retx=TRUE,center=TRUE,scale=TRUE)
```


```R
prinModel$rotation[,1:2,drop=F]
```




<table>
<thead><tr><th></th><th scope=col>PC1</th><th scope=col>PC2</th></tr></thead>
<tbody>
	<tr><th scope=row>tongshuai</th><td>-0.04946858</td><td> 0.70833235</td></tr>
	<tr><th scope=row>wuli</th><td>-0.3270496</td><td> 0.5956875</td></tr>
	<tr><th scope=row>zhili</th><td>0.5754873</td><td>0.1312234</td></tr>
	<tr><th scope=row>zhengzhi</th><td> 0.58384129</td><td>-0.01965349</td></tr>
	<tr><th scope=row>meili</th><td>0.4674774</td><td>0.3547053</td></tr>
</tbody>
</table>





```R
summary(prinModel)
```




    Importance of components:
                              PC1    PC2     PC3     PC4     PC5
    Standard deviation     1.6184 1.3412 0.55524 0.38961 0.34941
    Proportion of Variance 0.5238 0.3598 0.06166 0.03036 0.02442
    Cumulative Proportion  0.5238 0.8836 0.94522 0.97558 1.00000



对数据进行主成份分析，发现前两个主成份的累积方差贡献率达到88％，还不错，第一PC以智力和政治为主，达到50％贡献率，第二PC以武力和统率为主，达到30％贡献率。那么第一主成份可以认为是文韬因素，第二主成份可以认为是武略因素。好的，下面可以根据两个主成份得分列出文韬前十和武略。

#### 武略榜


```R
data$name[order(prinModel$x[,2],decreasing=T)][1:10]
```




<ol class=list-inline>
	<li>關羽</li>
	<li>趙雲</li>
	<li>曹操</li>
	<li>孫策</li>
	<li>孫堅</li>
	<li>黃忠</li>
	<li>周瑜</li>
	<li>陸遜</li>
	<li>夏侯惇</li>
	<li>姜維</li>
</ol>




#### 文韬榜


```R
data$name[order(prinModel$x[,1],decreasing=T)][1:10]
```




<ol class=list-inline>
	<li>郭嘉</li>
	<li>張紘</li>
	<li>張昭</li>
	<li>諸葛亮</li>
	<li>荀彧</li>
	<li>諸葛瑾</li>
	<li>荀攸</li>
	<li>曹植</li>
	<li>魯肅</li>
	<li>馬良</li>
</ol>




下面要将这两个主成分合为一个综合指标，采用加权平均方法，权重是方差贡献率，大致上0.6＊文韬＋0.4＊武略，下面就取出兼资文武之名将前十名，他们是：


```R
final<-prinModel$x[,1]*0.6+prinModel$x[,2]*0.4
```


```R
data$name[order(final,decreasing=T)][1:10]
```




<ol class=list-inline>
	<li>諸葛亮</li>
	<li>曹操</li>
	<li>周瑜</li>
	<li>陸遜</li>
	<li>司馬懿</li>
	<li>趙雲</li>
	<li>魯肅</li>
	<li>姜維</li>
	<li>龐統</li>
	<li>徐庶</li>
</ol>




看来在三国志的游戏数据中，诸葛亮是最强人物啊。最后来看看蜀国五虎排序，通常民间排序是关张赵马黄，这种序列显然没有考虑到智力因素问题啊，下面我们用前面的评价体系来为五虎重新排序。


```R
shu5 <- c('趙雲','馬超','張飛','關羽','黃忠')
```


```R
data.frame(round(prinModel$x[data$name %in% shu5,1:2],2),
           final=round(final[data$name %in% shu5],2),
           name=data$name[data$name %in% shu5])
```




<table>
<thead><tr><th></th><th scope=col>PC1</th><th scope=col>PC2</th><th scope=col>final</th><th scope=col>name</th></tr></thead>
<tbody>
	<tr><th scope=row>1</th><td>-1.51</td><td>2.22</td><td>-0.02</td><td>馬超</td></tr>
	<tr><th scope=row>2</th><td>-2.65</td><td>1.31</td><td>-1.07</td><td>張飛</td></tr>
	<tr><th scope=row>3</th><td>0.59</td><td>2.92</td><td>1.52</td><td>黃忠</td></tr>
	<tr><th scope=row>4</th><td>1.68</td><td>3.31</td><td>2.34</td><td>趙雲</td></tr>
	<tr><th scope=row>5</th><td>1.2</td><td>3.48</td><td>2.12</td><td>關羽</td></tr>
</tbody>
</table>




从上面这个表格可以看到，根据游戏数据正确的排序应该是赵关黄马张，赵云君，我看好你啊。我们还可以看看五虎将在群雄中的位置，将PC1和PC2做散点图如下，这张图中处于右上角的就是文韬武略兼备的人才。


```R
library(ggplot2)
```


```R
ggdata<-data.frame(prinModel$x[,1:2],name=data$name)
```


```R
p<-ggplot(ggdata,aes(PC1,PC2))+
    geom_point(size=3,alpha=0.5)+
    geom_text(data=subset(ggdata,name %in% shu5),
              aes(label=name))+
    labs(x="文韬"，y="武略")+
    theme bw()
```


    Error in parse(text = x, srcfile = src): <text>:5:13: unexpected input
    4:               aes(label=name))+
    5:     labs(x="文韬"<ef>
                   ^




```R
wen<-'文韬'
```


```R
wu<-'武略'
```


```R
p <- ggplot(ggdata,aes(PC1,PC2))+
    geom_point(size=3,alpha=0.5)+
    geom_text(data=subset(ggdata,name %in% shu5),
              aes(label=name))+
   labs(x=wen,y=wu)+
   theme_bw()
```


```R
print(p)
```

![](http://i12.tietuku.com/e67040bd65e145a0.png)

中文显示还是有问题，有待修正。


#### 雷达图


```R

```
